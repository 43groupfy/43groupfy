---
title: RL - Improved Reinforcement Learning through Imitation Learning Pretraining Towards Image-based Autonomous Drivings
author: Bean
date: 2022-04-30 09:32:00 +0800
categories: [Reinforcement learning, Autonomous driving]
tags: [Autonomous driving, Reinforcement learning, paper]
cover:  assets/img/post_images/driving_cover.jpg
layout: post
current: post
class: post-template
subclass: 'post'
navigation: True
cover:  assets/img/post_images/driving_cover2.jpg
---

`Improved Reinforcement Learning through Imitation Learning Pretraining Towards Image-based Autonomous Drivings` and `Autonomous Driving Based on Modified SAC Algotirhm through Imitation Learning Pre-training`, which will be covered in the next article, were written in the lab of Prof. Dong Eui Chang at KAIST and deal with how to improve autonomous driving learning using reinforcement learning.

More specifically, in the image-based autonomous driving task, imitation learning and reinforcement learning are combined and used together to utilize each others' strength. The difference between the two papers is that the first paper uses DDPG as reinforcement learning whereas the second paper uses SAC.

## Background
&nbsp;
* The problem of generating control decision given a monocular camera image and other auxiliary vehicle sensors’ outputs has aroused a lot of interest in recent years.
* Conducting imitation learning towards given human policy might produce a relative well-performed policy
  * However, limitation on the possible policy performance and the potential lack of generalizability for unseen situations.
* Instead, using RL in a simulator and then transfer the learned policy to real world is very popular in recent research.
  * Nonetheless, when the state and action spaces are huge or high dimensional, pure RL algorithm training process usually diverges.
* They present a method which combines these two methods and thus leverage both their advantages for this image-based autonomous driving task.

## Proposed method
\
&nbsp;
(1) pre-training(imitation learning) -> (2) fine-tuning(DDPG)
* Network architecture
  <div style="text-align: left">
    <img src="/assets/img/post_images/rl_driving1_1.png" width="70%"/>
  </div>
  * ResNet-34 architecture
    * One of CNN network for deep reinforcement learning tasks like environmental perception, model compression, and object detection
    * Use ResNet-34 as the backbone structure for both actor and critic networks
    * The simple and light ResNet-34 out performs other architectures with attention module integrated in terms of both final testing loss and the generated policy’s performance.

* Imitation learning phase
  * Aim to generate a good initial policy
  * Consider current image input and current vehicle speed as our current state inputs, and throttle, brake from zero to one and steering from minus one to positive one as our control outputs
  * Use Huber loss : to less sensitive to outliers and can make the training process more stable compared to MSE as a result.

* Reinforcement learning phase
  * Reward : distance to the nearest obstacle and current velocity
    <div style="text-align: left">
      <img src="/assets/img/post_images/rl_driving1_2.png" width="100%"/>
    </div>
  * Continuous and deterministic policy setting : to prevent possible catastrophic effect under undesired behavior.
  * In order to combine with imitation learning, they make several changes on the original DDPG
    * actor, critic networks
      * actor network : give all the weights of the pre-trained actor network to the actor networks used in the DDPG.
      * critic network : give all the weights except the final fully connected layer to critic networks used in the DDPG.
    * replay pool : train actor and critic networks using the samples collected under imitation learning’s generated policy. Then, use normal DDPG to collect new experience
    * removing OU noise

## Experiments
&nbsp;

* Imitation learning phase
  * Use an Xbox controller to control the car under various weather and lighting conditions and record the data using Airsim API
  * 1000 for each episode and terminates when a collision happens.
  * Randomly choose the weather condition and the initial position of the car before each episode starts and calculate a 5 episodes’ average accumulated reward as the criteria.
* RL phase
  * Same setting as imitation learnin phase

* Results
  <div style="text-align: left" >
    <img width="70%" src="/assets/img/post_images/rl_driving1_3.png" width="100%"/>
  </div>
  * Eventually, their proposed method achieves a considerable performance boost from the original imitation learning’s learned policy while the pure DDPG never performs well and does not show any improving trend.
